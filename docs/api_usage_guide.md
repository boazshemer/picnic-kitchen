# ××“×¨×™×š ×©×™××•×© ×‘-API

## ×”×¨×¦×ª ×”×©×¨×ª

### Windows (PowerShell):
```powershell
# ×”×¤×¢×œ ××ª ×”×¡×‘×™×‘×” ×”×•×™×¨×˜×•××œ×™×ª
.\venv\Scripts\Activate.ps1

# ×”×¨×¥ ××ª ×”×©×¨×ª
python main.py
```

### ×›×ª×•×‘×ª ×”×©×¨×ª:
```
http://localhost:8000
```

### ×ª×™×¢×•×“ ××™× ×˜×¨××§×˜×™×‘×™ (Swagger):
```
http://localhost:8000/docs
```

---

## ğŸ“‹ Endpoints

### 1. ×‘×“×™×§×ª ×ª×§×™× ×•×ª

**GET /** - ×“×£ ×‘×™×ª
```bash
curl http://localhost:8000/
```

**×ª×’×•×‘×”:**
```json
{
  "message": "ğŸ½ï¸ ×‘×¨×•×š ×”×‘× ×œ××¢×¨×›×ª × ×™×”×•×œ ××©×™××•×ª ××¤×¢×œ ××–×•×Ÿ",
  "version": "1.0.0",
  "status": "running",
  "docs": "/docs"
}
```

---

**GET /health** - ×‘×“×™×§×ª ×ª×§×™× ×•×ª
```bash
curl http://localhost:8000/health
```

**×ª×’×•×‘×”:**
```json
{
  "status": "healthy",
  "timestamp": "2025-12-23T10:30:00",
  "supabase_configured": true,
  "external_api_configured": true
}
```

---

### 2. ×©×œ×™×¤×ª ×× ×•×ª

**GET /dishes** - ×§×‘×œ×ª ×›×œ ×”×× ×•×ª

```bash
curl http://localhost:8000/dishes
```

**×ª×’×•×‘×” (×“×•×’××”):**
```json
[
  {
    "id": "abc-123-uuid",
    "name": "×©× ×™×¦×œ",
    "description": "×©× ×™×¦×œ ×¢×•×£ ×¤×¨×™×š",
    "category": "×¢×™×§×¨×™×ª",
    "preparation_time": 30,
    "default_cook_id": "xyz-789-uuid",
    "default_cook": {
      "id": "xyz-789-uuid",
      "name": "××©×” ×›×”×Ÿ",
      "floor": 1,
      "specialty": "×‘×©×¨×™",
      "email": "moshe@factory.com",
      "phone": "050-1234567",
      "is_active": true
    },
    "is_active": true
  },
  {
    "id": "def-456-uuid",
    "name": "×¤×¡×˜×”",
    "description": "×¤×¡×˜×” ×¢× ×¨×•×˜×‘ ×¢×’×‘× ×™×•×ª",
    "category": "×¢×™×§×¨×™×ª",
    "preparation_time": 25,
    "default_cook_id": "abc-999-uuid",
    "default_cook": {
      "id": "abc-999-uuid",
      "name": "×©×¨×” ×œ×•×™",
      "floor": 2,
      "specialty": "×—×œ×‘×™",
      "email": "sarah@factory.com",
      "phone": "050-2345678",
      "is_active": true
    },
    "is_active": true
  }
]
```

---

### 3. ×©×œ×™×—×ª ×”×–×× ×” ×™×•××™×ª

**POST /submit-order** - ×™×¦×™×¨×ª ×”×–×× ×” ×—×“×©×”

#### ×“×•×’××” 1: ×©×™××•×© ×‘×˜×‘×— ×‘×¨×™×¨×ª ××—×“×œ

```bash
curl -X POST "http://localhost:8000/submit-order" \
  -H "Content-Type: application/json" \
  -d '{
    "order_date": "2025-12-23",
    "items": [
      {
        "dish_id": "abc-123-uuid",
        "quantity": 100,
        "notes": "×¨×’×™×œ"
      },
      {
        "dish_id": "def-456-uuid",
        "quantity": 80
      }
    ]
  }'
```

**×”×¡×‘×¨:**
- `assigned_cook_id` ×œ× ×¦×•×™×Ÿ â†’ ×”××¢×¨×›×ª ×ª×©×ª××© ×‘×˜×‘×— ×‘×¨×™×¨×ª ×”××—×“×œ ×©×œ ×›×œ ×× ×”

---

#### ×“×•×’××” 2: ×“×¨×™×¡×” ×™×“× ×™×ª ×©×œ ×˜×‘×—

```bash
curl -X POST "http://localhost:8000/submit-order" \
  -H "Content-Type: application/json" \
  -d '{
    "order_date": "2025-12-23",
    "items": [
      {
        "dish_id": "abc-123-uuid",
        "quantity": 100,
        "assigned_cook_id": "different-cook-uuid",
        "notes": "×˜×‘×— ××—×¨"
      }
    ]
  }'
```

**×”×¡×‘×¨:**
- `assigned_cook_id` ×¦×•×™×Ÿ â†’ ×”××¢×¨×›×ª ×ª×©×ª××© ×‘×˜×‘×— ×”×–×” ×‘××§×•× ×‘×¨×™×¨×ª ×”××—×“×œ

---

**×ª×’×•×‘×ª ×”×¦×œ×—×”:**
```json
{
  "success": true,
  "message": "×”×”×–×× ×” × ×•×¦×¨×” ×‘×”×¦×œ×—×”! ×¡×”×´×› 180 ×× ×•×ª × ×©×œ×—×• ×œ×©×¨×ª ×”×—×™×¦×•× ×™",
  "data": {
    "order_date": "2025-12-23",
    "total_dishes": 180,
    "items_count": 2,
    "external_sync": true,
    "external_error": null
  }
}
```

---

**×ª×’×•×‘×ª ×©×’×™××” (×•×œ×™×“×¦×™×”):**
```json
{
  "detail": [
    {
      "type": "value_error",
      "loc": ["body", "items", 0, "quantity"],
      "msg": "×›××•×ª ×—×™×™×‘×ª ×œ×”×™×•×ª ×—×™×•×‘×™×ª",
      "input": -5
    }
  ]
}
```

---

## ğŸ” ××™×š Pydantic ××‘×˜×™×— ×ª×§×™× ×•×ª?

### ×‘×›× ×™×¡×” (××”×©×¤×™×ª):

1. **×¡×•×’×™ × ×ª×•× ×™×**
   - `order_date` ×—×™×™×‘ ×œ×”×™×•×ª ×ª××¨×™×š
   - `quantity` ×—×™×™×‘ ×œ×”×™×•×ª ××¡×¤×¨ ×©×œ×
   - `dish_id` ×—×™×™×‘ ×œ×”×™×•×ª UUID

2. **×•×œ×™×“×¦×™×” ××ª×§×“××ª**
   - ×ª××¨×™×š ×œ× ×™×›×•×œ ×œ×”×™×•×ª ×‘×¢×‘×¨
   - ×›××•×ª ×—×™×™×‘×ª ×œ×”×™×•×ª 1-500
   - ×—×™×™×‘×ª ×œ×”×™×•×ª ×œ×¤×—×•×ª ×× ×” ××—×ª

3. **×× ×™×© ×‘×¢×™×”**
   - FastAPI ××—×–×™×¨ ×©×’×™××” 422 ××•×˜×•××˜×™×ª
   - ×¢× ×”×¡×‘×¨ ××“×•×™×§ ××” ×œ× ×‘×¡×“×¨
   - ×”×”×–×× ×” ×œ× ××ª×§×“××ª

### ×‘×¤× ×™× (×œ×•×’×™×§×”):

1. **×©×œ×™×¤×ª × ×ª×•× ×™× ××”×“××˜×”×‘×™×™×¡**
   - ×‘×•×“×§ ×©×”×× ×” ×§×™×™××ª
   - ×‘×•×“×§ ×©×”×˜×‘×— ×§×™×™×
   - ×‘×•×“×§ ×©×™×© ×˜×‘×— ×‘×¨×™×¨×ª ××—×“×œ (×× ×œ× ×‘×—×¨×• ×™×“× ×™×ª)

2. **×‘× ×™×™×ª ×”××™×“×¢ ×œ×’×™×**
   - ×™×•×¦×¨ `ExternalOrderPayload`
   - Pydantic ×‘×•×“×§ ×©×›×œ ×”×©×“×•×ª ×ª×§×™× ×™×
   - ×××™×¨ ×ª××¨×™×›×™× ×œ×¤×•×¨××˜ × ×›×•×Ÿ

### ×‘×™×¦×™××” (×œ×©×¨×ª ×©×œ ×’×™×):

1. **×¡×¨×™××œ×™×–×¦×™×”**
   - Pydantic ×××™×¨ ×œ-JSON × ×§×™
   - UUID â†’ string
   - datetime â†’ ISO format
   - None â†’ null

2. **×•×œ×™×“×¦×™×” ××—×¨×•× ×”**
   - ×›×œ ×”×©×“×•×ª ×”× ×“×¨×©×™× ×§×™×™××™×
   - ××™×Ÿ ×©×“×•×ª ×¨×™×§×™×
   - ×”×¤×•×¨××˜ ×ª×§×™×Ÿ

3. **×ª×•×¦××”**
   - **×’×™× ×ª××™×“ ×™×§×‘×œ × ×ª×•× ×™× ×ª×§×™× ×™×!** âœ…
   - ×× ×™×© ×‘×¢×™×”, ×”×™× ×ª×ª×’×œ×” ×œ×¤× ×™ ×”×©×œ×™×—×”
   - ×”×—×™×¡×›×•×Ÿ: ×¤×—×•×ª ×‘××’×™×, ×¤×—×•×ª ×ª×™××•××™× ×¢× ×’×™×

---

## ğŸ§ª ×‘×“×™×§×•×ª ×¢× Python

### ×”×ª×§× ×ª requests:
```bash
pip install requests
```

### ×¡×§×¨×™×¤×˜ ×œ×‘×“×™×§×”:

```python
import requests

# 1. ×‘×“×™×§×ª ×ª×§×™× ×•×ª
response = requests.get("http://localhost:8000/health")
print("Health:", response.json())

# 2. ×©×œ×™×¤×ª ×× ×•×ª
response = requests.get("http://localhost:8000/dishes")
dishes = response.json()
print(f"× ××¦××• {len(dishes)} ×× ×•×ª")

# 3. ×©×œ×™×—×ª ×”×–×× ×”
order_data = {
    "order_date": "2025-12-23",
    "items": [
        {
            "dish_id": dishes[0]["id"],  # ×× ×” ×¨××©×•× ×”
            "quantity": 50
        }
    ]
}

response = requests.post(
    "http://localhost:8000/submit-order",
    json=order_data
)

if response.status_code == 201:
    print("âœ… ×”×–×× ×” × ×•×¦×¨×” ×‘×”×¦×œ×—×”!")
    print(response.json())
else:
    print("âŒ ×©×’×™××”:", response.json())
```

---

## ğŸ“Š ×ª×™×¢×•×“ ××™× ×˜×¨××§×˜×™×‘×™ (Swagger UI)

**×’×© ×œ-http://localhost:8000/docs**

×©× ×ª×•×›×œ:
- ğŸ‘€ ×œ×¨××•×ª ××ª ×›×œ ×”-Endpoints
- ğŸ“– ×œ×§×¨×•× ×”×¡×‘×¨×™× ×¢×œ ×›×œ ××—×“
- ğŸ§ª ×œ×‘×“×•×§ ×‘×§×©×•×ª ×™×©×™×¨×•×ª ××”×“×¤×“×¤×Ÿ
- ğŸ“ ×œ×¨××•×ª ×“×•×’×××•×ª Request/Response

×–×” ××•×˜×•××˜×™! FastAPI ×™×¦×¨ ××ª ×–×” ×‘×¢×‘×•×¨×š ğŸ‰

---

## ğŸ› ×˜×™×¤×•×œ ×‘×©×’×™××•×ª × ×¤×•×¦×•×ª

### ×©×’×™××”: "×—×¡×¨×™× SUPABASE_URL ××• SUPABASE_KEY"

**×¤×ª×¨×•×Ÿ:**
1. ×•×•×“× ×©×™×© ×§×•×‘×¥ `.env` (×œ× `env.example`)
2. ×¤×ª×— ××ª `.env` ×•×•×“× ×©×”×¢×¨×›×™× ××œ××™×
3. ××ª×—×œ ××ª ×”×©×¨×ª ××—×“×©

---

### ×©×’×™××”: "×× ×” ×œ× × ××¦××”"

**×¤×ª×¨×•×Ÿ:**
- ×”-UUID ×©×œ ×”×× ×” ×œ× ×§×™×™× ×‘××¡×“ ×”× ×ª×•× ×™×
- ×‘×“×•×§ ××ª ×”×¨×©×™××” ×‘-GET /dishes

---

### ×©×’×™××”: "×œ× × ×™×ª×Ÿ ×œ×™×¦×•×¨ ×”×–×× ×” ×œ×ª××¨×™×š ×©×¢×‘×¨"

**×¤×ª×¨×•×Ÿ:**
- ×”×–×Ÿ ×ª××¨×™×š ×©×œ ×”×™×•× ××• ×¢×ª×™×“×™
- ×¤×•×¨××˜: "YYYY-MM-DD" (2025-12-23)

---

## ğŸ’¡ ×˜×™×¤×™×

1. **×”×©×ª××© ×‘×ª×™×¢×•×“ ×”××™× ×˜×¨××§×˜×™×‘×™** - `/docs` ×–×” ×”×“×¨×š ×”×§×œ×” ×‘×™×•×ª×¨ ×œ×‘×“×•×§
2. **×‘×“×•×§ ××ª ×”×œ×•×’×™×** - ×›×œ ×¤×¢×•×œ×” ××ª×•×¢×“×ª ×‘×˜×¨××™× ×œ
3. **×”×ª×—×œ ×¢× GET /dishes** - ×›×“×™ ×œ×¨××•×ª ××” ×™×© ×‘××¢×¨×›×ª
4. **×©××•×¨ UUIDs** - ×ª×¦×˜×¨×š ××•×ª× ×œ×‘×§×©×•×ª POST


